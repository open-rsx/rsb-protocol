CMAKE_MINIMUM_REQUIRED(VERSION 2.6)
SET(CMAKE_ALLOW_LOOSE_LOOP_CONSTRUCTS TRUE)

MACRO(INSTALL_FILES_WITH_DIRECTORY FILE_LIST)

    FOREACH(HEADER ${${FILE_LIST}})
        STRING(REGEX MATCH "(.*)[/\\]" DIR ${HEADER})
        INSTALL(FILES ${HEADER} DESTINATION share/${DIR})
    ENDFOREACH(HEADER)

ENDMACRO()

SET(PROTOFILES rsbprotocol/Attachment.proto
               rsbprotocol/Notification.proto
               rsbprotocol/introspection/PortStateChange.proto)

INSTALL_FILES_WITH_DIRECTORY(PROTOFILES)

SET(RSBPROTO_ROOT ${CMAKE_INSTALL_PREFIX}/share/rsbprotocol)
FOREACH(F ${PROTOFILES})
    SET(PROTOFILES_WITH_ROOT ${PROTOFILES_WITH_ROOT} "${CMAKE_INSTALL_PREFIX}/share/${F}")
ENDFOREACH()
CONFIGURE_FILE(RSBProtocolConfig.cmake.in ${CMAKE_CURRENT_BINARY_DIR}/RSBProtocolConfig.cmake @ONLY)
INSTALL(FILES ${CMAKE_CURRENT_BINARY_DIR}/RSBProtocolConfig.cmake DESTINATION share/RSBProtocol)
